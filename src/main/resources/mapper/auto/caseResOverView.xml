<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.honda.interauto.dao.auto.CaseResOverViewDao">
    <resultMap id="baseCaseResOverView" type="com.honda.interauto.entity.CaseResOverViewEntity">
        <id property="id" column="id" jdbcType="BIGINT"/>
        <id property="tagId" column="tagId" jdbcType="VARCHAR"/>
        <id property="totalCount" column="total" jdbcType="BIGINT"/>
        <id property="failCount" column="fail" jdbcType="BIGINT"/>
        <id property="successCount" column="success" jdbcType="BIGINT"/>
        <id property="operator" column="operator" jdbcType="VARCHAR"/>
        <result property="startTime" column="startTime" javaType="java.lang.String" jdbcType="TIMESTAMP"/>
        <result property="endTime" column="endTime" javaType="java.lang.String" jdbcType="TIMESTAMP"/>
    </resultMap>

    <sql id="caseResOverView">
		tagId, total, fail, success, operator, startTime, endTime
	</sql>

    <insert id="recordOverView" parameterType="com.honda.interauto.entity.CaseResOverViewEntity" keyProperty="id" useGeneratedKeys="true">
        insert into t_caseRes_overView (<include refid="caseResOverView"/>) values(#{tagId}, #{totalCount}, #{failCount}, #{successCount}, #{operator},
        #{startTime, jdbcType=TIMESTAMP}, #{endTime, jdbcType=TIMESTAMP})
    </insert>

    <select id="getAllOverView" parameterType="int" resultMap="baseCaseResOverView">
        select id, <include refid="caseResOverView"/> from t_caseRes_overView t where 1 = 1
        order by t.startTime desc
        limit ${(pageNum - 1) * pageSize}, ${pageNum * pageSize}
    </select>

    <select id="getOperatorOverView" parameterType="int" resultMap="baseCaseResOverView">
        select id, <include refid="caseResOverView"/> from t_caseRes_overView t where 1 = 1
        <!--and <if test="pageNum != null">t.id &gt; (#{pageNum} - 1) * #{pageSize} and t.id &lt;= (#{pageNum} * #{pageSize})</if>-->
        and <if test="operator != null">t.operator = #{operator}</if>
        order by t.startTime desc
        limit ${(pageNum - 1) * pageSize}, ${pageNum * pageSize}
    </select>

    <select id="getCountRes" resultType="int">
        select count(*) from t_caseRes_overView
    </select>
</mapper>